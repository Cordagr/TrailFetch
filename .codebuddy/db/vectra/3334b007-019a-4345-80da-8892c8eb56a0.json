{"chunk":0,"numChunks":1,"fileHash":"ZrfK9KbZmb34tQ2DAn51WxxbzAL61vIoZG80XJ8YZeo=","filePath":"backend/routes/searchTrails.js","content":"const express = require('express');\r\nconst axios = require('axios');\r\nrequire('dotenv').config(); // Load environment variables\r\n\r\nconst searchTrailsRouter = express.Router();\r\n\r\nsearchTrailsRouter.get('/searchTrails', async (req, res) => {\r\n  let { location, radius } = req.query;\r\n\r\n  if (!location || !radius) {\r\n    return res.status(400).json({ error: 'Location and radius are required' });\r\n  }\r\n\r\n  const apiKey = 'AIzaSyCv3TTKGJirVR5w8ZfM6D582oZwB1tQUVQ';\r\n\r\n  try {\r\n    // Convert location (city or address) to latitude & longitude\r\n    const geoUrl = `https://maps.googleapis.com/maps/api/geocode/json?address=${encodeURIComponent(location)}&key=${apiKey}`;\r\n    const geoResponse = await axios.get(geoUrl);\r\n\r\n    if (geoResponse.data.status !== 'OK' || geoResponse.data.results.length === 0) {\r\n      return res.status(400).json({ error: 'Invalid location. Please enter a valid city or address.' });\r\n    }\r\n\r\n    const { lat, lng } = geoResponse.data.results[0].geometry.location;\r\n\r\n    // Fetch nearby hiking trails\r\n    const googlePlacesUrl = `https://maps.googleapis.com/maps/api/place/nearbysearch/json?location=${lat},${lng}&radius=${radius}&keyword=hiking%20trail&type=point_of_interest&key=${apiKey}`;\r\n    const response = await axios.get(googlePlacesUrl);\r\n\r\n    res.json(response.data);\r\n  } catch (err) {\r\n    console.error('Error fetching trails:', err);\r\n    res.status(500).json({ error: 'Server error. Please try again later.' });\r\n  }\r\n});\r\n\r\nmodule.exports = searchTrailsRouter;\r\n"}