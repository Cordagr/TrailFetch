{"chunk":0,"numChunks":1,"fileHash":"DnIijCrU+RGus2rD7D4HMeAPEjjuWQbWJ7sJVCS4Nw0=","filePath":"backend/middleware/auth.js","content":"const jwt = require('jsonwebtoken');\r\n\r\nconst auth = (req, res, next) => {\r\n  const token = req.header('Authorization').replace('Bearer ', '');\r\n  if (!token) {\r\n    return res.status(401).json({ error: 'Access denied. No token provided.' });\r\n  }\r\n\r\n  try {\r\n    const decoded = jwt.verify(token, 'your_jwt_secret');\r\n    req.user = decoded;\r\n    next();\r\n  } catch (err) {\r\n    res.status(400).json({ error: 'Invalid token.' });\r\n  }\r\n};\r\n\r\nmodule.exports = auth;"}