{"chunk":0,"numChunks":1,"fileHash":"OesWC2zGTgeYQ3jJHu5MvvqfvlPeVnR5exuHsDhMdco=","filePath":"backend/routes/register.js","content":"const express = require('express');\r\nconst jwt = require('jsonwebtoken');\r\nconst bcrypt = require('bcryptjs');\r\n\r\nconst User = require('../models/register');\r\n\r\nconst registerRouter = express.Router();\r\n\r\nregisterRouter.post('/register', (req, res) => {\r\n  const today = new Date();\r\n  const userData = {\r\n    first_name: req.body.first_name,\r\n    last_name: req.body.last_name,\r\n    email: req.body.email,\r\n    password: req.body.password,\r\n    created: today\r\n  }\r\n\r\n  User.findOne({\r\n    email: req.body.email\r\n  })\r\n    .then(user => {\r\n      if (!user) {\r\n        bcrypt.hash(req.body.password, 10, (err, hash) => {\r\n          userData.password = hash\r\n          const newUser = new User(userData);\r\n          newUser.save()\r\n            .then(user => {\r\n              res.json({ status: user.email + ' registered!' })\r\n            })\r\n            .catch(err => {\r\n              res.send('error: ' + err)\r\n            })\r\n        })\r\n      } else {\r\n        res.json({ error: ' user already exists' })\r\n      }\r\n    })\r\n    .catch(err => {\r\n      res.send('error: ' + err)\r\n    })\r\n})\r\n\r\nmodule.exports = registerRouter;\r\n"}